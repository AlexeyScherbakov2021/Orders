<Window x:Class="Orders.Views.OrderWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:comm="clr-namespace:Orders.Infrastructure.Commands"
        xmlns:vm="clr-namespace:Orders.ViewModels"
        xmlns:local="clr-namespace:Orders.Views"
        mc:Ignorable="d"
        Title="Заказ" Height="600" Width="800" WindowStartupLocation="CenterScreen">
    <Window.DataContext>
        <vm:OrderWindowViewModel/>
    </Window.DataContext>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="201*"/>
            <ColumnDefinition Width="199*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="41"/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <ToolBar Grid.ColumnSpan="2">
            <Button Margin="2" Content="Отправить" Command="{Binding SendCommand}" Style="{StaticResource ButtonStyleShadow}" />
            <Button Margin="2" Content="Отказать" Command="{Binding}" Style="{StaticResource ButtonStyleShadow}" />
            <Button Margin="2" Content="Вернуть" Command="{Binding}" Style="{StaticResource ButtonStyleShadow}" />
            <Button Margin="2" Content="Закрыть" Command="{Binding }" Style="{StaticResource ButtonStyleShadow}" />
        </ToolBar>

        <Border Grid.Column="0" Grid.Row="1" Margin="10" Background="#FFF1F1F1" Padding="6">
            <Border.Effect>
                <DropShadowEffect Color="#FFBDBDBD" ShadowDepth="0" BlurRadius="20"/>
            </Border.Effect>
            <GroupBox Header="Рассмотрение заказа">
                <Grid Margin="4">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="109"/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="22"/>
                        <RowDefinition Height="22"/>
                        <RowDefinition Height="22"/>
                        <RowDefinition Height="22"/>
                        <RowDefinition Height="22"/>
                        <RowDefinition Height="100"/>
                        <RowDefinition Height="22"/>
                        <RowDefinition Height="100"/>
                        <RowDefinition Height="22"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TextBlock x:Name="textBlock" Text="Номер" Grid.ColumnSpan="2" VerticalAlignment="Center" Height="16" />
                    <TextBlock Text="Наименование" Grid.Row="1" Grid.ColumnSpan="2" VerticalAlignment="Center" Height="16" />
                    <TextBlock Text="Статус" Grid.Row="2" Grid.ColumnSpan="2" VerticalAlignment="Center" Height="16" />
                    <TextBlock Text="Время создания" Grid.Row="3" Grid.ColumnSpan="2" VerticalAlignment="Center" Height="16" />

                    <TextBlock Text="{Binding order.o_number}" Grid.Column="1" VerticalAlignment="Center" FontWeight="Bold" Height="16"/>
                    <TextBlock Text="{Binding order.o_name}" Grid.Row="1" Grid.Column="1" VerticalAlignment="Center" FontWeight="Bold" Height="16" />
                    <TextBlock Text="{Binding order.RouteStatus.sr_name}" Grid.Row="2" Grid.Column="1" VerticalAlignment="Center" FontWeight="Bold" Height="16"/>
                    <TextBlock Text="{Binding order.o_date_created, StringFormat=dd.MM.yyyy HH:mm:ss}" Grid.Row="3" Grid.Column="1" VerticalAlignment="Center" FontWeight="Bold" Height="16"/>

                    <TextBlock Text="Описание заказа" Grid.Row="4" VerticalAlignment="Center" Height="16" />
                    <TextBox Text="{Binding order.o_body}" IsReadOnly="True" Grid.Row="5"  Grid.ColumnSpan="2"/>
                    <TextBlock Text="Добавить сообщение" Grid.Row="6" VerticalAlignment="Center" Height="16" Grid.ColumnSpan="2" />
                    <TextBox Text="{Binding CurrentStep.ro_text}" Grid.Row="7" Grid.ColumnSpan="2"/>

                    <TextBlock Text="Прикрепить файлы" Grid.Row="8" VerticalAlignment="Center" Height="16" />

                    <Button Content="..." Command="{Binding BrowseCommand}" Grid.Row="8" Grid.Column="1" Width="26" Height="20" HorizontalAlignment="Left" VerticalAlignment="Center" Style="{DynamicResource ButtonStyleShadow}"/>
                    <ItemsControl ItemsSource="{Binding ListFiles}" BorderBrush="Black" BorderThickness="1,1,1,1" 
                                  Grid.Row="9" Grid.ColumnSpan="2">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <DockPanel>
                                    <Button Content="X" Width="20" DockPanel.Dock="Right"/>
                                    <TextBlock Text="{Binding ad_text}"/>
                                </DockPanel>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>


                </Grid>
            </GroupBox>
        </Border>



        <Border Grid.Column="1" Grid.Row="1" Margin="10" Background="#FFF1F1F1" Padding="6">
            <Border.Effect>
                <DropShadowEffect Color="#FFBDBDBD" ShadowDepth="0" BlurRadius="20"/>
            </Border.Effect>
            <GroupBox Header="Маршрут заказа" BorderBrush="#FFADADAD">
                <ItemsControl ItemsSource="{Binding order.RouteOrders}" Margin="2"
                      BorderBrush="Black" BorderThickness="0" HorizontalContentAlignment="Stretch" 
                      ScrollViewer.VerticalScrollBarVisibility="Auto" >
                    <ItemsControl.Template>
                        <ControlTemplate>
                            <Border
                    BorderThickness="{TemplateBinding Border.BorderThickness}"
                    Padding="{TemplateBinding Control.Padding}"
                    BorderBrush="{TemplateBinding Border.BorderBrush}"
                    Background="{TemplateBinding Panel.Background}"
                    SnapsToDevicePixels="True">
                                <ScrollViewer>
                                    <ItemsPresenter/>
                                </ScrollViewer>
                            </Border>
                        </ControlTemplate>
                    </ItemsControl.Template>

                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border HorizontalAlignment="Stretch"  VerticalAlignment="Stretch" Margin="10,3,3,1" 
                            BorderBrush="Black" Padding="0,3,3,3" CornerRadius="3" BorderThickness="1,1,1,1"  >
                                <Border.Effect>
                                    <DropShadowEffect ShadowDepth="0" BlurRadius="9" Color="#FFBBBBBB"/>
                                </Border.Effect>
                                <Border.Background>
                                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                        <LinearGradientBrush.RelativeTransform>
                                            <TransformGroup>
                                                <ScaleTransform CenterY="0.5" CenterX="0.5"/>
                                                <SkewTransform CenterX="0.5" CenterY="0.5"/>
                                                <RotateTransform Angle="90" CenterX="0.5" CenterY="0.5"/>
                                                <TranslateTransform/>
                                            </TransformGroup>
                                        </LinearGradientBrush.RelativeTransform>
                                        <GradientStop Color="#FFD5EFFF"/>
                                        <GradientStop Color="#FFF9FDFF" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                                <DockPanel Margin="0,0,0,0">
                                    <Grid Width="20" Margin="0,-3,0,-3">
                                        <Ellipse Fill="White"  Width="25" Height="25" HorizontalAlignment="Center" VerticalAlignment="Center" 
                                                 Margin="-17,0,-6,0" Stroke="#FF1D0AFF" StrokeThickness="2">
                                            <Ellipse.Effect>
                                                <DropShadowEffect ShadowDepth="1" Color="#FF9C9C9C"/>
                                            </Ellipse.Effect>
                                        </Ellipse>
                                        <TextBlock Text="{Binding ro_step}" FontWeight="Bold"  
                                                   Foreground="Black" VerticalAlignment="Center" 
                                                   HorizontalAlignment="Center" Margin="-11,0,0,0" FontSize="14" />
                                    </Grid>
                                    <ItemsControl DockPanel.Dock="Bottom" ItemsSource="{Binding RouteAddings}" ScrollViewer.VerticalScrollBarVisibility="Disabled" VerticalContentAlignment="Center" Margin="2,0,0,0">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel  />
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Background="#FFFFFDD8" CornerRadius="3" BorderThickness="1" BorderBrush="Gray" Margin="1" Padding="1" HorizontalAlignment="Left" Cursor="Hand">
                                                    <Border.Effect>
                                                        <DropShadowEffect ShadowDepth="0" BlurRadius="9" Color="#FFBBBBBB"/>
                                                    </Border.Effect>

                                                    <TextBlock Text="{Binding ad_text}"/>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                    <Border DockPanel.Dock="Bottom" BorderBrush="#FFCCCCCC" BorderThickness="0,1,0,0" Margin="2,0,0,0">
                                        <TextBlock Text="{Binding ro_text}" TextWrapping="Wrap"/>
                                    </Border>
                                    <Grid Margin="2,0,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition Width="110"/>
                                            <ColumnDefinition Width="20"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding User.u_name}" Grid.Column="0" FontWeight="Bold"/>
                                        <TextBlock Text="{Binding RouteStatus.sr_name}" Grid.Column="1" Foreground="#FF00BB1D"/>
                                        <CheckBox IsChecked="{Binding ro_check}" Grid.Column="2"/>
                                    </Grid>
                                </DockPanel>
                            </Border>


                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>

            </GroupBox>
        </Border>

        <!--<TextBlock HorizontalAlignment="Left" Margin="115,12,0,0" Text="Маршрут заказа" VerticalAlignment="Top" Grid.Row="1" Height="16" Width="90" Grid.Column="1"/>-->

    </Grid>
</Window>
